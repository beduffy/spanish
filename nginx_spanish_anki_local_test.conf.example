server {
    listen 8081; # We'll use port 8081 for local testing to avoid conflicts
    server_name localhost;

    auth_basic "Spanish Anki - Restricted Access";
    auth_basic_user_file /etc/nginx/.htpasswd_local_test; # Path to the password file

    location /api/ {
        # Proxy to your Django backend API
        proxy_pass http://127.0.0.1:8000; # Assuming Django dev server runs on port 8000
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }

    location / {
        # Proxy to your Vue.js frontend
        # This assumes your Vue dev server is running on port 8080
        proxy_pass http://127.0.0.1:8080; 
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade"; # Required for WebSocket connections if Vue dev server uses them (e.g., for hot reloading)
    }

    # If you have static files managed separately by Django (e.g. /static/admin/), 
    # you might need another location block for them, also protected.
    # For a typical Vue CLI setup, /static/ often refers to files within the Vue app's public folder,
    # which would be served by Vue dev server and proxied via "location /".
}
