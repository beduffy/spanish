# Spanish Anki Web App

[![Django CI](https://github.com/beduffy/spanish/actions/workflows/ci.yml/badge.svg)](https://github.com/beduffy/spanish/actions/workflows/ci.yml)
[![codecov](https://codecov.io/gh/beduffy/spanish/graph/badge.svg)](https://codecov.io/gh/beduffy/spanish)

## Overview

This project is a web application that allows users to learn Spanish using an Anki-like flashcard system. It provides a simple, clean interface for reviewing Spanish sentences and tracking progress. Vibe coded.

## Project Structure (Django)

This project follows a standard Django structure. Here's an overview of the key files and directories within the `anki_web_app` directory:

*   **`manage.py`**: 
    *   A command-line utility that lets you interact with this Django project in various ways. 
    *   You use it to run the development server, create database migrations, run tests, create a superuser, run custom management commands (like our `import_csv`), etc.
    *   Example: `python manage.py runserver`, `python manage.py makemigrations`, `python manage.py migrate`.

*   **`spanish_anki_project/`** (Project Configuration Directory):
    *   This directory is the container for your project-wide settings and configurations.
    *   `__init__.py`: An empty file that tells Python that this directory should be considered a Python package.
    *   `settings.py`: Contains all the settings and configurations for your Django project, such as database setup, installed apps, middleware, template directories, static files configuration, secret key, etc. We've modified this to add our `flashcards` app and `rest_framework`.
    *   `urls.py`: The main URL declarations for your project. It maps URL patterns to views. Think of it as the main table of contents for your site's URLs.
    *   `wsgi.py`: An entry-point for WSGI-compatible web servers to serve your project (used for deployment).
    *   `asgi.py`: An entry-point for ASGI-compatible web servers to serve your project (for asynchronous features, also used for deployment).

*   **`flashcards/`** (Django App Directory):
    *   This is one of the applications within your Django project. Django projects are typically composed of multiple apps, each handling a distinct piece of functionality.
    *   `__init__.py`: Makes this directory a Python package.
    *   `admin.py`: Used to register your models with Django's built-in admin interface, allowing you to easily manage your data through a web interface.
    *   `apps.py`: Configuration for this specific app (e.g., `FlashcardsConfig`).
    *   `models.py`: This is where you define your database schema by creating Python classes (models). Each class maps to a database table, and its attributes map to table columns. We defined our `Sentence` and `Review` models here.
    *   `tests.py`: Contains test cases for your app. We've written unit tests here for the `import_csv` command and the SRS logic in `models.py`.
    *   `views.py`: (Will be created later) Contains the logic that handles requests and returns responses. This is where our API endpoints will be defined.
    *   `urls.py`: (Will be created later, specific to the `flashcards` app) Contains URL declarations for this specific app. These are usually included into the main project's `urls.py`.
    *   `migrations/`: This directory stores database migration files. Migrations are Django's way of propagating changes you make to your models (adding a field, deleting a model, etc.) into your database schema. 
        *   `0001_initial.py`, etc.: Files generated by `python manage.py makemigrations`.
    *   `management/`: A directory to hold custom management commands.
        *   `commands/`: Subdirectory where command modules are placed.
            *   `import_csv.py`: Our custom command to import data from the CSV file.

*   **`data/`** (Custom Directory):
    *   This is where we are storing your input CSV file (`Spanish - 2000 words in context_may_15th_2025.csv`). Not a standard Django directory, but a common practice for project data.

*   **`db.sqlite3`** (Database File):
    *   The SQLite database file that Django created and uses to store all your application data (Sentences, Reviews, user accounts if you add them, etc.), based on the models defined.

*   **`venv/` or Conda environment (`py38`)** (Virtual Environment - not explicitly in the list but implied by setup):
    *   Isolates project-specific dependencies (like Django, Django REST framework) from other Python projects on your system.

This structure helps in organizing code logically, making it easier to manage and scale the application.

## Development Setup

### Backend (Django)

1.  **Navigate to the backend directory:**
    ```bash
    cd anki_web_app
    ```
2.  **Activate your Python virtual environment** (e.g., Conda `py38` or your `venv`).
3.  **Apply database migrations:**
    ```bash
    python manage.py migrate
    ```
4.  **(Optional) Import initial data from CSV:**
    Make sure your CSV file (e.g., `data/Spanish - 2000 words in context_may_15th_2025.csv`) is in the `anki_web_app/data/` directory.
    ```bash
    python manage.py import_csv data/your_csv_file_name.csv
    ```
5.  **Run the Django development server:**
    ```bash
    python manage.py runserver
    ```
    The backend API will typically be available at `http://127.0.0.1:8000/`.

### Frontend (Vue.js)

1.  **Navigate to the frontend directory:**
    ```bash
    cd anki_web_app/spanish_anki_frontend 
    ```
    (If you are in the `anki_web_app` directory, use `cd spanish_anki_frontend`)
2.  **Install dependencies:**
    ```bash
    npm install
    ```
3.  **Run the Vue development server:**
    ```bash
    npm run serve
    ```
    The frontend application will typically be available at `http://localhost:8080/`.

## Running Tests

This project includes backend tests (Django), frontend unit tests (Jest), and frontend end-to-end tests (Cypress).

### Run All Tests (Recommended)

A script is provided in the project root to run all test suites sequentially:

1.  **Navigate to the project root directory:**
    ```bash
    cd /path/to/your/spanish_anki_project # Or simply `cd ..` if you are in `anki_web_app`
    ```
2.  **Make the script executable (if you haven't already):**
    ```bash
    chmod +x run_all_tests.sh
    ```
3.  **Execute the script:**
    ```bash
    ./run_all_tests.sh
    ```
    This will run Django tests, then Jest unit tests, then Cypress E2E tests.

### Individual Test Suites

You can also run each test suite individually:

*   **Backend Django Tests:**
    Navigate to the `anki_web_app` directory and run:
    ```bash
    python manage.py test
    ```

*   **Frontend Unit Tests (Jest):**
    Navigate to the `anki_web_app/spanish_anki_frontend` directory and run:
    ```bash
    npm run test:unit
    ```

*   **Frontend E2E Tests (Cypress):**
    Navigate to the `anki_web_app/spanish_anki_frontend` directory.
    To run in headless mode:
    ```bash
    npx cypress run
    ```
    To open the Cypress Test Runner UI:
    ```bash
    npx cypress open
    ```